<!DOCTYPE html>
<html>
<head>
    <title>Users</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-5">

    <h2>Users</h2>

    <!-- Input Fields -->
    <div class="row mb-3">
        <div class="col">
            <input type="text" id="name" class="form-control" placeholder="Enter Name">
        </div>
        <div class="col">
            <input type="email" id="email" class="form-control" placeholder="Enter Email">
        </div>
        <div class="col">
            <button class="btn btn-primary" onclick="addUser()">Add User</button>
        </div>
    </div>

    <!-- Table -->
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Email</th>
            </tr>
        </thead>
        <tbody id="userTable">
        </tbody>
    </table>

    <!-- âœ… SCRIPT MUST BE AT BOTTOM -->
    <script>
    async function addUser() {
        const name = document.getElementById("name").value;
        const email = document.getElementById("email").value;

        const response = await fetch("/users", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                name: name,
                email: email
            })
        });

        if (response.ok) {
            loadUsers();
        } else {
            console.error("Error creating user");
        }
    }

    async function loadUsers() {
        const response = await fetch("/users");
        const users = await response.json();

        const table = document.getElementById("userTable");
        table.innerHTML = "";

        users.forEach(user => {
            table.innerHTML += `
                <tr>
                    <td>${user.id}</td>
                    <td>${user.name}</td>
                    <td>${user.email}</td>
                </tr>
            `;
        });
    }

    // Load users when page opens
    loadUsers();
    </script>

</body>
</html>